<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€šç”¨ - StreamaxçŸ¥è¯†åº“</title>
    <!-- å¼•å…¥Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding-top: 50px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">é€šç”¨</h1>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../index.html">é¦–é¡µ</a></li>
                <li class="breadcrumb-item active" aria-current="page">é€šç”¨</li>
            </ol>
        </nav>
        
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">é€šç”¨æ–‡æ¡£</h5>
                <p class="card-text">Streamaxé€šç”¨æ–‡æ¡£</p>
            </div>
        </div>
        
        <div class="mt-5">
            <h2>æ–‡ä»¶åˆ—è¡¨</h2>
            <div class="card">
                <div class="card-body">
                    <ul id="file-list" class="list-group list-group-flush">
                        <!-- æ–‡ä»¶åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </ul>
                </div>
            </div>
        </div>
        
        <footer class="mt-5 pt-4 border-top">
            <p class="text-muted">Â© 2026 StreamaxçŸ¥è¯†åº“</p>
        </footer>
    </div>
    
    <!-- å¼•å…¥Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // GitHub API é…ç½®
        const repoOwner = 'maozuxiao';
        const repoName = 'Streamax';
        const branch = 'main';
        
        // è·å–å½“å‰ç›®å½•è·¯å¾„ï¼Œç¡®å®šAPIè¯·æ±‚è·¯å¾„
        const currentPath = window.location.pathname;
        
        // GitHub Pages URLç»“æ„ï¼šhttps://username.github.io/repoName/directory/file.html
        // æå–ç›®å½•è·¯å¾„ï¼Œè€ƒè™‘åˆ°GitHub Pageså°†docsç›®å½•ä½œä¸ºæ ¹ç›®å½•
        let apiPath = 'docs';
        
        // åˆ†å‰²è·¯å¾„
        const parts = currentPath.split('/');
        const repoIndex = parts.indexOf(repoName);
        
        // ç¡®å®šæ˜¯å¦ä¸ºæ ¹ç›®å½•
        let isRoot = true;
        let currentDir = '';
        
        if (repoIndex !== -1) {
            if (parts.length > repoIndex + 2) {
                // æå–repoNameåçš„ç›®å½•è·¯å¾„
                // parts = ['', 'repoName', 'directory', 'file.html']
                const subPath = parts.slice(repoIndex + 1, -1).join('/'); // ç§»é™¤æ–‡ä»¶åï¼Œä¿ç•™ç›®å½•è·¯å¾„
                apiPath = `docs/${subPath}`;
                isRoot = false;
                currentDir = subPath + '/';
            } else if (parts.length === repoIndex + 2) {
                // æ ¹ç›®å½•æƒ…å†µï¼šhttps://username.github.io/repoName/
                apiPath = 'docs';
                isRoot = true;
                currentDir = '';
            }
        } else {
            // æœ¬åœ°æµ‹è¯•æˆ–ç›´æ¥è®¿é—®docsç›®å½•çš„æƒ…å†µ
            if (parts.length > 2) {
                // parts = ['', 'directory', 'file.html']
                const subPath = parts.slice(1, -1).join('/'); // ç§»é™¤æ–‡ä»¶åï¼Œä¿ç•™ç›®å½•è·¯å¾„
                apiPath = `docs/${subPath}`;
                isRoot = false;
                currentDir = subPath + '/';
            } else {
                // æ ¹ç›®å½•æƒ…å†µï¼šhttp://localhost:8000/
                apiPath = 'docs';
                isRoot = true;
                currentDir = '';
            }
        }
        
        // è·å–æ–‡ä»¶åˆ—è¡¨å®¹å™¨
        const fileList = document.getElementById('file-list');
        
        // ä½¿ç”¨GitHub APIè·å–æ–‡ä»¶åˆ—è¡¨
        fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${apiPath}?ref=${branch}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`GitHub API è¯·æ±‚å¤±è´¥: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                // æ¸…ç©ºæ–‡ä»¶åˆ—è¡¨
                fileList.innerHTML = '';
                
                // æ”¯æŒçš„æ–‡ä»¶æ ¼å¼
                const supportedFormats = ['.pdf', '.md', '.markdown', '.html'];
                
                // è¦æ’é™¤çš„æ–‡ä»¶
                const excludedFiles = ['index.html', 'readme.md', 'markdown-viewer.html'];
                
                // åˆ†ç¦»ç›®å½•å’Œæ–‡ä»¶
                const folders = data.filter(item => item.type === 'dir');
                const files = data.filter(item => 
                    item.type === 'file' && 
                    supportedFormats.includes('.' + item.name.split('.').pop().toLowerCase()) && 
                    !excludedFiles.includes(item.name.toLowerCase())
                );
                
                // å…ˆæ·»åŠ ç›®å½•ï¼Œå†æ·»åŠ æ–‡ä»¶
                folders.forEach(folder => {
                    const listItem = document.createElement('li');
                    listItem.className = 'list-group-item file-item';
                    listItem.setAttribute('data-file-name', folder.name.toLowerCase());
                    
                    const icon = document.createElement('span');
                    icon.className = 'icon me-2';
                    icon.textContent = 'ğŸ“';
                    
                    const link = document.createElement('a');
                    link.href = `${folder.name}/index.html`;
                    link.textContent = folder.name;
                    link.className = 'text-decoration-none';
                    link.target = '_self';
                    
                    listItem.appendChild(icon);
                    listItem.appendChild(link);
                    fileList.appendChild(listItem);
                });
                
                // æ·»åŠ æ–‡ä»¶
                files.forEach(file => {
                    const listItem = document.createElement('li');
                    listItem.className = 'list-group-item file-item';
                    listItem.setAttribute('data-file-name', file.name.toLowerCase());
                    
                    const icon = document.createElement('span');
                    icon.className = 'icon me-2';
                    
                    // æ ¹æ®æ–‡ä»¶ç±»å‹è®¾ç½®ä¸åŒå›¾æ ‡
                    if (file.name.endsWith('.html')) {
                        icon.textContent = 'ğŸŒ';
                    } else if (file.name.endsWith('.pdf')) {
                        icon.textContent = 'ğŸ“„';
                    } else if (file.name.endsWith('.md') || file.name.endsWith('.markdown')) {
                        icon.textContent = 'ğŸ“';
                    }
                    
                    const link = document.createElement('a');
                    link.className = 'text-decoration-none';
                    
                    // æ„å»ºæ–‡ä»¶é“¾æ¥
                    const fileExtension = '.' + file.name.split('.').pop().toLowerCase();
                    if (fileExtension === '.md' || fileExtension === '.markdown') {
                        // MDæ–‡ä»¶ä½¿ç”¨markdown-viewer.html
                        // ç¡®ä¿ç”Ÿæˆçš„è·¯å¾„æ­£ç¡®ï¼Œä¸åŒ…å«å¤šä½™çš„docs/å‰ç¼€
                        let filePath = file.path;
                        // ä»file.pathä¸­æå–docs/åé¢çš„è·¯å¾„
                        // file.pathæ ¼å¼ï¼šdocs/filename.md æˆ– docs/subdir/filename.md
                        if (filePath.startsWith('docs/')) {
                            filePath = filePath.slice(5); // ç§»é™¤docs/å‰ç¼€
                        }
                        link.href = `../markdown-viewer.html?file=${encodeURIComponent(filePath)}`;
                    } else {
                        // HTMLå’ŒPDFæ–‡ä»¶ç›´æ¥æ‰“å¼€
                        link.href = file.name;
                    }
                    
                    link.textContent = file.name;
                    
                    listItem.appendChild(icon);
                    listItem.appendChild(link);
                    fileList.appendChild(listItem);
                });
                
                // å¦‚æœæ²¡æœ‰æ–‡ä»¶ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
                if (folders.length === 0 && files.length === 0) {
                    const listItem = document.createElement('li');
                    listItem.className = 'list-group-item text-muted';
                    listItem.textContent = 'å½“å‰ç›®å½•ä¸‹æ²¡æœ‰æ”¯æŒçš„æ–‡ä»¶';
                    fileList.appendChild(listItem);
                }
            })
            .catch(error => {
                console.error('Error fetching files:', error);
                // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                const listItem = document.createElement('li');
                listItem.className = 'list-group-item text-danger';
                listItem.textContent = `æ— æ³•è·å–æ–‡ä»¶åˆ—è¡¨: ${error.message}`;
                fileList.appendChild(listItem);
            });
    </script>
</body>
</html>