<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>云平台 - Streamax知识库</title>
    <!-- 引入Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding-top: 50px;
        }
        .card {
            transition: transform 0.2s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">云平台</h1>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../index.html">首页</a></li>
                <li class="breadcrumb-item active" aria-current="page">云平台</li>
            </ol>
        </nav>
        
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">云平台概述</h5>
                <p class="card-text">Streamax云平台解决方案提供了全方位的车辆监控、管理和数据分析服务，支持多种行业应用场景。</p>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Ceiba2</h5>
                        <p class="card-text">Ceiba2是Streamax新一代云平台，提供强大的车辆管理、视频监控和数据分析功能。</p>
                        <a href="Ceiba2/index.html" class="btn btn-primary">查看详情</a>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">FT Cloud</h5>
                        <p class="card-text">FT Cloud是面向货运行业的专业云平台，提供车辆跟踪、货物监控和运营管理服务。</p>
                        <a href="FT_Cloud/index.html" class="btn btn-primary">查看详情</a>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">PT Cloud</h5>
                        <p class="card-text">PT Cloud是面向公共交通行业的云平台，提供公交调度、乘客信息和运营分析服务。</p>
                        <a href="PT_Cloud/index.html" class="btn btn-primary">查看详情</a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">云平台核心功能</h5>
                <ul>
                    <li>实时视频监控：支持远程查看车辆内部和外部视频</li>
                    <li>车辆定位跟踪：实时掌握车辆位置和行驶轨迹</li>
                    <li>告警管理：接收和处理车辆异常告警信息</li>
                    <li>数据分析：提供运营数据统计和分析报告</li>
                    <li>远程配置：支持远程更新设备配置和固件</li>
                    <li>多级权限管理：满足不同角色的权限需求</li>
                </ul>
            </div>
        </div>
        
        <div class="mt-5">
            <h2>文件列表</h2>
            <div class="card">
                <div class="card-body">
                    <ul id="file-list" class="list-group list-group-flush">
                        <!-- 文件列表将通过JavaScript动态生成 -->
                    </ul>
                </div>
            </div>
        </div>
        
        <footer class="mt-5 pt-4 border-top">
            <p class="text-muted">© 2026 Streamax知识库</p>
        </footer>
    </div>
    
    <!-- 引入Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // 支持的文件格式
        const supportedFormats = ['.pdf', '.md', '.markdown', '.html'];
        
        // GitHub API 配置
        const repoOwner = 'maozuxiao';
        const repoName = 'Streamax';
        const branch = 'main';
        const docsPath = 'docs';
        
        // 获取当前目录路径
        const currentPath = window.location.pathname;
        let apiPath = docsPath;
        
        // 解析当前路径，提取docs目录后的部分
        const docsIndex = currentPath.indexOf('/docs/');
        if (docsIndex !== -1) {
            // 提取/docs/后的路径部分
            const docsPathPart = currentPath.slice(docsIndex + 6); // +6 是因为 '/docs/' 有6个字符
            
            // 处理路径部分，移除可能的文件名
            let pathParts = docsPathPart.split('/');
            
            // 如果最后一部分包含文件扩展名，或者是常见的文件名（如index.html），则移除它
            const lastPart = pathParts[pathParts.length - 1];
            if (lastPart && (lastPart.includes('.') || lastPart.toLowerCase() === 'index.html')) {
                pathParts = pathParts.slice(0, -1);
            }
            
            // 构建目录路径
            const dirPath = pathParts.join('/');
            if (dirPath) {
                apiPath = `${docsPath}/${dirPath}`;
            }
        }
        
        // 获取文件列表容器
        const fileList = document.getElementById('file-list');
        
        // 使用GitHub API获取文件列表
        fetch(`https://api.github.com/repos/${repoOwner}/${repoName}/contents/${apiPath}?ref=${branch}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // 过滤出文件，排除目录
                const files = data.filter(item => item.type === 'file');
                
                // 处理文件列表
                const processedFiles = files.map(file => {
                    const fileName = file.name;
                    const fileExtension = '.' + fileName.split('.').pop().toLowerCase();
                    return { name: fileName, type: fileExtension };
                });
                
                // 过滤文件，只显示支持的格式，并排除特定文件
        const excludedFiles = ['index.html', 'readme.md', 'markdown-viewer.html'];
        const filteredFiles = processedFiles.filter(file => 
            supportedFormats.includes(file.type) && 
            !excludedFiles.includes(file.name.toLowerCase())
        );
        
        // 按文件名排序
        filteredFiles.sort((a, b) => a.name.localeCompare(b.name));
        
        // 生成文件列表
        filteredFiles.forEach(file => {
            const listItem = document.createElement('li');
            listItem.className = 'list-group-item';
            
            const link = document.createElement('a');
            link.href = '#';
            link.textContent = file.name;
            link.className = 'text-decoration-none';
            
            // 根据文件类型设置不同的处理逻辑
            link.addEventListener('click', (e) => {
                e.preventDefault();
                
                if (file.type === '.md' || file.type === '.markdown') {
                    // 对于md文件，跳转到markdown渲染器页面
                    // 构造相对路径
                    let relativePath = '';
                    if (currentPath.includes('/docs/') && currentPath !== '/docs/' && currentPath !== '/docs/index.html') {
                        const pathParts = currentPath.split('/docs/')[1];
                        const dirPath = pathParts.split('/').slice(0, -1).join('/');
                        if (dirPath) {
                            relativePath = `${dirPath}/${file.name}`;
                        } else {
                            relativePath = file.name;
                        }
                    } else {
                        relativePath = file.name;
                    }
                    window.location.href = `../markdown-viewer.html?file=${encodeURIComponent(relativePath)}`;
                } else if (file.type === '.html') {
                    // 对于html文件，直接打开，不管是否有同名的md文件
                    window.location.href = file.name;
                } else {
                    // 对于pdf文件，直接打开
                    window.location.href = file.name;
                }
            });
            
            listItem.appendChild(link);
            fileList.appendChild(listItem);
        });
                
                // 如果没有文件，显示提示信息
                if (filteredFiles.length === 0) {
                    const listItem = document.createElement('li');
                    listItem.className = 'list-group-item text-muted';
                    listItem.textContent = '当前目录下没有支持的文件';
                    fileList.appendChild(listItem);
                }
            })
            .catch(error => {
                console.error('Error fetching files:', error);
                // 如果API调用失败，显示错误信息
                const listItem = document.createElement('li');
                listItem.className = 'list-group-item text-danger';
                listItem.textContent = '无法获取文件列表，请稍后重试';
                fileList.appendChild(listItem);
            });
    </script>
</body>
</html>